---
title: 'Demo #5 - ABM project'
author: "KTH Library & ITA - ABM project"
date: '2020-11-10'
output:
  ioslides_presentation:
    css: assets/css/styles.css
    logo: assets/img/logo.svg
    mathjax: default
    self-contained: yes
    transition: slower
    widescreen: yes
  beamer_presentation: default
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(ktheme)
library(webshot)

red <- function(txt) 
  sprintf("<font color='%s'>\n%s\n</font>", tolower(palette_kth()["cerise"]), txt)

#webshot::install_phantomjs()
#unlink("retrosearch-screenshot.png")

suppressPackageStartupMessages(library(magick))

# BG images that could be used

```

## Background 

**Goal:** 

> Replace the previous ABM i.e. Annual Bibliometric Monitoring / Årlig Bibliometrisk Uppföljning at KTH

**Summary:**

Our [previous demo meeting](https://KTH-Library.github.io/demo-4) was held 2020-05-26. Since then we have worked (remotely) on Sprints **17 to 23** (current).

The [ABM services at KTH](https://kth.se/abm) have been operational since the last demo meeting, with some operational maintenance involving rotation of certificates made during the autumn.

## Agenda {data-background=assets/bg/kth-6.png data-background-size=cover}

> *Please use the Zoom chat for questions*

- Progress - What is **new** since last meeting?

- A short **demo** of the current work

- Update about **data integration** (Scopus etc)

- Update about **other efforts** (API for public data from ABM etc)

- Your **questions and feedback**, suggestions and comments

- Future **directions**

## What is new? {data-background=assets/bg/plant.png data-background-size=cover}

- During the autumn, we have primarily focused on a `r red("proof of concept for author based")` reporting showing results at divisional level, based on currently employed researcher and their publication outputs.

- Data integration work has been initiated with regards to using `r red("Scopus data")` from Elsevier in order to complement the WoS data.


## Demo

  - Introduction to ABM for new attendees
  - Demonstration of new author based POC for KTH divisions
  - Comparison versus existing ABM model, with examples
    - Two divisions
    - Two institutions
    - Explanations 

## Scopus (Peer-reviewed) {.smaller}

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(readxl)
library(dplyr)
library(formattable)
library(DT)

versus <- bind_rows(
  read_xlsx("Coverage.xlsx") %>%
    mutate(peerreviewed = TRUE),
  read_xlsx("Coverage.xlsx", sheet = 2) %>%
    mutate(peerreviewed = FALSE)
)

d1 <- 
  versus %>% select(-c("Department id")) %>% 
  mutate_at(5:8, function(x) round(x, 1))
  
d2 <- d1 %>%
  filter(peerreviewed == TRUE, `WoS coverage (%)` > 0) %>%
  select(-c("peerreviewed"))
  
d3 <- d1 %>%
  filter(peerreviewed == FALSE, `WoS coverage (%)` > 0) %>%
  select(-c("peerreviewed"))

color_tile_divergent <- function(x) ifelse(x <= 0, 
  color_tile("lightpink", "transparent")(x * c(x <= 0)),
  color_tile("transparent", "lightblue")(x * c(x > 0)))

fdt <- function(data)
  as.datatable(rownames = FALSE, options = list(
    pageLength = 300L, bPaginate = FALSE, scrollY = 400,
    dom = 'ftB'), x = formattable(data, list(
    `Total publications` = color_bar("lightblue"),
    `Publications in Scopus` = color_bar("lightblue"),
    `Publications in WoS` = color_bar("lightblue"),
    `Scopus coverage (%)` = color_bar("lightgray"),
    `WoS coverage (%)` = color_bar("lightgray"),
    `Scopus coverage gain (%)` = color_tile_divergent
    )))

dt1 <- fdt(d2)
dt2 <- fdt(d3)

```

```{r}
dt1
```

## Scopus (Non Peer-reviewed) {.smaller}

```{r}
dt2
```

## Data integration

- Scopus data from Elsevier has been acquired
- Further use of [`kthapi` R package](https://github.com/KTH-Library/kthapi) has been the basis for the POC
- A new R package [`semanticscholar`](https://github.com/KTH-Library/semanticscholar) allows for experimenting with data integration against this data source which provides open data for publications from many researchers at KTH.

## Other efforts

- API for public data from ABM: https://bibliometrics.lib.kth.se/testapi
- Operations and maintenance
  - we have separated operational ABM services from other KTHB Bibliometrics services and have allowed external users without KTH accounts to log in via the use of auth0
  - we have initiated a migration from Travis - a continuous integration provider Travis - to using GitHub Actions.
  - we have upgraded the software stack and server environment (rotated certificates and API keys)
  - we have continued to work with the KTH Web team aiming to align with the KTH style for web applications
